<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>55Guh</title>
<link href="https://fonts.googleapis.com/css2?family=Oswald:wght@700&display=swap" rel="stylesheet">
<style>
    body {
        font-family: 'Oswald', sans-serif;
        font-weight: 700;
        background: #f5f5f5;
        color: #222;
        padding: 20px;
    }
    h1 {
        font-size: 2em;
        margin-bottom: 5px;
    }
    #datetime {
        font-size: 1.2em;
        margin-bottom: 20px;
        color: #555;
    }
    a {
        display: block;
        padding: 4px 0;
        text-decoration: none;
        color: #0073e6;
    }
    a:hover {
        text-decoration: underline;
    }
    .folder {
        font-weight: bold;
    }
    .back {
        margin-bottom: 15px;
        display: inline-block;
    }
    .size {
        color: #888;
        font-size: 0.9em;
    }
</style>
</head>
<body>
<h1>55Guh</h1>
<div id="datetime"></div>
<div id="file-list"></div>

<script>
function updateDateTime() {
    const now = new Date();
    const months = [
        "January", "February", "March", "April", "May", "June",
        "July", "August", "September", "October", "November", "December"
    ];
    const day = now.getDate();
    const suffix = (day % 10 === 1 && day !== 11) ? "st" :
                   (day % 10 === 2 && day !== 12) ? "nd" :
                   (day % 10 === 3 && day !== 13) ? "rd" : "th";
    const formattedDate = `${months[now.getMonth()]} ${day}${suffix}, ${now.getFullYear()}`;
    const formattedTime = now.toLocaleTimeString();
    document.getElementById("datetime").textContent = `${formattedDate} ‚Äî ${formattedTime}`;
}
setInterval(updateDateTime, 1000);
updateDateTime();

async function loadRepo(path = "") {
    const apiUrl = `https://api.github.com/repos/55guh/55guh.github.io/contents/${path}`;
    const res = await fetch(apiUrl);
    if (!res.ok) {
        document.getElementById("file-list").innerHTML = `<p>Failed to load.</p>`;
        return;
    }
    let data = await res.json();

    const container = document.getElementById("file-list");
    container.innerHTML = "";

    if (path) {
        const parentPath = path.split("/").slice(0, -1).join("/");
        const backUrl = parentPath ? `?path=${parentPath}` : "";
        container.innerHTML += `<a href="${backUrl}" class="back">‚¨Ö Go Back</a>`;
    }

    data = data.filter(file => file.name !== "index.html");

    data.sort((a, b) => {
        if (a.type === b.type) {
            return a.name.localeCompare(b.name);
        }
        return a.type === "dir" ? -1 : 1;
    });

    data.forEach(file => {
        let icon = "";
        const lowerName = file.name.toLowerCase();

        if (/\.(exe|dmg|msi|bat|sh)$/.test(lowerName)) {
            icon = "üíª ";
        } else if (/\.(apk|ipa)$/.test(lowerName)) {
            icon = "üì± ";
        } else if (/\.(mp4|mov|avi|mkv|webm)$/.test(lowerName)) {
            icon = "üé• ";
        } else if (file.type === "dir") {
            icon = "üìÅ ";
        }

        if (file.type === "dir") {
            container.innerHTML += `<a class="folder" href="?path=${path ? path + "/" : ""}${file.name}">${icon}${file.name}</a>`;
        } else {
            const fileUrl = `https://55guh.github.io/${path ? path + "/" : ""}${file.name}`;
            const sizeKB = file.size ? ` <span class="size">(${(file.size / 1024).toFixed(1)} KB)</span>` : "";
            container.innerHTML += `<a href="${fileUrl}" target="_blank">${icon}${file.name}</a>${sizeKB}`;
        }
    });
}

const urlParams = new URLSearchParams(window.location.search);
const currentPath = urlParams.get("path") || "";
loadRepo(currentPath);
</script>
</body>
</html>
