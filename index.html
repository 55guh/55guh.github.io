<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>55Guh</title>
<link href="https://fonts.googleapis.com/css2?family=Oswald:wght@700&display=swap" rel="stylesheet">
<style>
  body {
    font-family: 'Oswald', sans-serif;
    margin: 20px;
    background-color: #f9f9f9;
  }
  h1 {
    font-size: 2em;
  }
  ul {
    list-style-type: none;
    padding: 0;
  }
  li {
    margin: 5px 0;
  }
  a {
    text-decoration: none;
    color: #0073e6;
  }
  a:hover {
    text-decoration: underline;
  }
  .date-time {
    margin-bottom: 15px;
    font-size: 1.1em;
  }
</style>
</head>
<body>

<h1>55Guh</h1>
<div class="date-time" id="dateTime"></div>
<button onclick="goBack()">Go Back</button>
<ul id="fileList"></ul>

<script>
const repoOwner = "55guh";
const repoName = "55guh.github.io";
const apiUrl = `https://api.github.com/repos/${repoOwner}/${repoName}/contents/`;
let currentPath = decodeURIComponent(window.location.pathname.replace(/^\/+/, ''));

if (currentPath.endsWith("/")) currentPath = currentPath.slice(0, -1);

function fetchFiles(path = "") {
  fetch(apiUrl + path)
    .then(response => response.json())
    .then(data => {
      const list = document.getElementById("fileList");
      list.innerHTML = "";
      data.forEach(file => {
        if (file.name.toLowerCase() === "index.html") return;

        let icon = "";
        const ext = file.name.split('.').pop().toLowerCase();

        if (["exe", "dmg", "msi"].includes(ext)) icon = "üíª ";
        else if (["apk", "ipa"].includes(ext)) icon = "üì± ";
        else if (["mp4", "avi", "mov", "webm", "mkv"].includes(ext)) icon = "üé• ";

        const li = document.createElement("li");
        if (file.type === "dir") {
          li.innerHTML = `üìÅ <a href="?path=${encodeURIComponent(path ? path + '/' + file.name : file.name)}">${file.name}</a>`;
        } else {
          li.innerHTML = `${icon}<a href="https://${repoName}/${path ? path + '/' + file.name : file.name}" target="_blank">${file.name}</a>`;
        }
        list.appendChild(li);
      });
    })
    .catch(err => {
      document.getElementById("fileList").innerHTML = "<li>Error loading files.</li>";
    });
}

function goBack() {
  if (!currentPath) return;
  let parts = currentPath.split('/');
  parts.pop();
  let newPath = parts.join('/');
  window.location.href = "?path=" + encodeURIComponent(newPath);
}

const urlParams = new URLSearchParams(window.location.search);
const pathFromUrl = urlParams.get("path");
if (pathFromUrl) {
  currentPath = decodeURIComponent(pathFromUrl);
}
fetchFiles(currentPath);

// Date + Time
function updateDateTime() {
  const now = new Date();
  const options = { month: 'long', day: 'numeric', year: 'numeric' };
  let day = now.getDate();
  let suffix = "th";
  if (day % 10 === 1 && day !== 11) suffix = "st";
  else if (day % 10 === 2 && day !== 12) suffix = "nd";
  else if (day % 10 === 3 && day !== 13) suffix = "rd";
  const formattedDate = now.toLocaleDateString("en-US", { month: "long" }) + " " + day + suffix + ", " + now.getFullYear();
  document.getElementById("dateTime").textContent = formattedDate;
}
updateDateTime();
</script>

</body>
</html>
