<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>55Guh</title>
<link href="https://fonts.googleapis.com/css2?family=Oswald:wght@700&display=swap" rel="stylesheet">
<style>
    body {
        font-family: 'Oswald', sans-serif;
        background-color: #f4f4f4;
        padding: 20px;
    }
    h1 {
        font-size: 2em;
        margin-bottom: 10px;
    }
    .item {
        padding: 5px 0;
        cursor: pointer;
    }
    .folder {
        font-weight: bold;
        color: blue;
    }
    .repo {
        font-weight: bold;
        color: green;
    }
    .back {
        display: inline-block;
        margin-bottom: 15px;
        cursor: pointer;
        color: red;
    }
    #clock {
        float: right;
        font-size: 1.2em;
    }
</style>
</head>
<body>
<h1>55Guh <span id="clock"></span></h1>
<div class="back" onclick="goBack()" id="back-btn" style="display:none;">‚¨Ö Go Back</div>
<div id="file-list"></div>

<script>
let currentRepo = null;
let currentPath = "";

function formatDate() {
    const date = new Date();
    const day = date.getDate();
    const daySuffix = day % 10 === 1 && day !== 11 ? 'st' :
                      day % 10 === 2 && day !== 12 ? 'nd' :
                      day % 10 === 3 && day !== 13 ? 'rd' : 'th';
    return date.toLocaleString('en-US', { month: 'long' }) + ' ' + day + daySuffix + ', ' + date.getFullYear();
}

function updateClock() {
    document.getElementById('clock').textContent = formatDate();
}
setInterval(updateClock, 1000);
updateClock();

// Load repos from 55guh
async function fetchRepos() {
    const res = await fetch(`https://api.github.com/users/55guh/repos`);
    const repos = await res.json();
    let html = "<h2>Select a Repository</h2>";
    repos.forEach(repo => {
        html += `<div class="item repo" onclick="openRepo('${repo.name}')">üì¶ ${repo.name}</div>`;
    });
    document.getElementById("file-list").innerHTML = html;
    document.getElementById("back-btn").style.display = "none";
}

async function fetchFiles(repo, path="") {
    const res = await fetch(`https://api.github.com/repos/55guh/${repo}/contents/${path}`);
    const files = await res.json();

    let folders = [];
    let fileItems = [];

    files.forEach(file => {
        if (file.name === "index.html") return; // exclude index.html
        let icon = "";
        if (file.type === "dir") {
            folders.push(`<div class="item folder" onclick="openPath('${file.path}')">üìÅ ${file.name}</div>`);
        } else {
            const ext = file.name.split('.').pop().toLowerCase();
            if (["exe", "dmg", "msi", "bat", "sh", "app"].includes(ext)) {
                icon = "üíª ";
            } else if (["apk", "ipa"].includes(ext)) {
                icon = "üì± ";
            } else if (["mp4", "mov", "avi", "mkv", "webm"].includes(ext)) {
                icon = "üé• ";
            }
            fileItems.push(`<div class="item"><a href="https://55guh.github.io/${repo}/${file.path}" target="_blank">${icon}${file.name}</a></div>`);
        }
    });

    document.getElementById("file-list").innerHTML = folders.join('') + fileItems.join('');
    document.getElementById("back-btn").style.display = "inline-block";
}

function openRepo(repo) {
    currentRepo = repo;
    currentPath = "";
    fetchFiles(repo);
}

function openPath(path) {
    currentPath = path;
    fetchFiles(currentRepo, path);
}

function goBack() {
    if (!currentRepo) return;
    if (!currentPath) {
        // back to repo list
        currentRepo = null;
        fetchRepos();
        return;
    }
    const parts = currentPath.split("/");
    parts.pop();
    currentPath = parts.join("/");
    fetchFiles(currentRepo, currentPath);
}

// Start by loading repo list
fetchRepos();
</script>
</body>
</html>
